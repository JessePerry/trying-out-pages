<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Kinect 2 for Windows Demo App by JessePerry</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Kinect 2 for Windows Demo App</h1>
        <p class="header">The Hands On Labs to complete a sample application for Windows 8.1 and the Kinect 2 for Windows</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/JessePerry/trying-out-pages/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/JessePerry/trying-out-pages/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/JessePerry/trying-out-pages">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/JessePerry">JessePerry</a></p>


      </header>
      <section>
        <h1>
<a id="kinect-2-hands-on-labs" class="anchor" href="#kinect-2-hands-on-labs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kinect 2 Hands On Labs</h1>

<h2>
<a id="lab-1-initial-kinect20-project-setup" class="anchor" href="#lab-1-initial-kinect20-project-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Lab 1: Initial Kinect2.0 Project Setup</h2>

<p>Estimated Time to Complete: 10min</p>

<p>This lab is part of a series which takes you through the creation process of a Windows 8.1 Store Application which uses every available feature of the Kinect 2. This is the first lab in the series, and it shows you how to set up the initial development environment to build an app using Kinect 2.</p>

<p>This lab will explain the following:
1. How to make a new project for Windows 8.1
2. How to download and reference the Kinect 2.0 SDK.
3. How to get the Kinect 2 sensor in code and build a successful app.
4. How to open the sensor and turn on the Kinect 2 from code.</p>

<p>This lab comes with a starting point solution and a completed solution of the covered exercises if required.</p>

<h2>
<a id="system-requirements" class="anchor" href="#system-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>System Requirements</h2>

<p>The target application is a Windows 8.1 Store application for x86 or x64 machines (not ARM) so a machine with an x86 or x64 architecture is required for development.
Supported Operating Systems and Architectures </p>

<ul>
<li>Windows 8.1 
### Software Requirements </li>
<li>Microsoft Visual Studio® 2013 Community Edition with Update 2 or higher.</li>
<li>Microsoft .NET Framework 4.5.</li>
<li>The Kinect 2 SDK (Currently at build 1409)
### Hardware Requirements</li>
<li>Kinect 2.0 for Windows device.</li>
<li>USB 3.0
## Project Scenario
For this lab, you will see how easy it is to set up and use the Kinect for Windows 2.0 SDK in a Windows 8.1 store application. 
The Kinect 2.0 SDK can also be used in a desktop application, by referencing a different library. 
When setting up the Kinect 2.0 device, please make sure you have correctly used a USB 3.0 port and not a USB 2.0 port. If you are unsure that the Kinect is plugged in properly, you can check a light indicator on the power box of the unit (the box which comes from the single cable in the Kinect 2 and results in power and USB 3.0 connections.
If the light on the power-box is <strong>Orange</strong> then something is wrong with either the power, Kinect 2, or USB3.0 connection.
If the light is <strong>White</strong> then the Kinect is correctly registered with windows as a device to be used. The Kinect 2.0 itself does not turn on until it is required by an application.</li>
</ul>

<h1>
<a id="exercise-1---project-setup" class="anchor" href="#exercise-1---project-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 1 - Project Setup</h1>

<p>This exercise will show you how to set up the development environment for building a Kinect for Windows 2 application in Windows 8.1, and how to access the <strong>Default Sensor</strong> in code. This lab and all subsequent labs in this series are build using C# and assumes you have a fundamental knowledge of the language.
The screenshots here are from <strong>Visual Studio Pro 2013 Update 2</strong> but Community Edition is identical.</p>

<ol>
<li><p>Open Visual Studio 2013 and create a new project in a directory you can access. 
Click File &gt; New &gt; Project and select a Blank App for Windows in C#. Name the project Kinect2Sample. Then click OK to create the project:
<strong>lab01img01</strong></p></li>
<li><p>The project will get created with the default MainPage.xaml and App.xaml added to the project in the Solution Explorer on the right:
<strong>lab01img02</strong></p></li>
<li><p>If you have not downloaded the public Kinect 2 SDK, you should download it and install it before proceeding: <a href="http://www.microsoft.com/en-us/download/details.aspx?id=44561">http://www.microsoft.com/en-us/download/details.aspx?id=44561</a> ~280MB</p></li>
<li><p>Once installed, the Kinect 2 SDK can be referenced for use in the new project. In the Solution Explorer, right click References and click <strong>Add Reference…</strong> to open the Reference Manager.</p></li>
<li><p>To add the WindowsPreview.Kinect.dll which uses the .NetCore library (suitable for Windows Store apps), follow these steps:
a. Click Extensions on the left.
b. In the center panel, scroll down to the bottom and check WindowsPreview.Kinect.
<strong>lab01img03</strong>
c. Click OK to add the reference.</p></li>
<li><p>Kinect 2.0 applications are compatible with x86 and x64 architectures and are not compatible with ARM systems. This dependency from the Kinect 2.0 library means that you must change the project configuration to either x86 or x64 instead of the currently set “Any CPU”. 
a. Click BUILD then Configuration Manager… to open the Configuration Manager.
b. Click the dropdown box under Active Solution Platform: and select x64.
<strong>lab01img04</strong>
c. Click Close.
d. Now open the project properties by right Clicking the Kinect2Sample project in the solution explorer, then clicking Properties.
e. Click the Build tab on the left, then beside Platform: select x64 from the dropdown.
f. Click FILE, then Save All or hit Ctrl + Shift + S to save all files.</p></li>
<li><p>Now you can build and run the application to make sure the references work and are compatible. Click BUILD then Build Solution, then the project will build and present no errors. To Run or Debug the application students can either:
a. Click DEBUG then Start Debugging, or
b. In the Debug toolbar, click the Green Arrow Play button next to the target environment which should be set to Local Machine.
<strong>lab01img05</strong></p></li>
</ol>

<p>The application will install on the Local Machine as a Windows 8.1 Store app and launch itself with Visual Studio as the attached debugger. </p>

<ol>
<li>Upon running or debugging the application, you will see a gray screen, because there is nothing yet in the application to show. Back in Visual Studio, select the menu DEBUG, Stop Debugging or click the Red Stop Square in the Debugging toolbar.</li>
</ol>

<p>In the future, the steps 7 and 8 are required when asked to Build and Run the application.</p>

<ol>
<li><p>Open the MainPage.xaml.cs code behind file in Visual Studio by double clicking it.</p></li>
<li><p>To get the default sensor for the Kinect, add the WindowsPreview.Kinect namespace, and a private class level variable for the KinectSensor.  Then in the constructor of MainPage class select the default sensor and open it. To do this, add the highlighted code below:</p></li>
</ol>

<pre><code>// ... other namespaces
**using WindowsPreview.Kinect;**

namespace Kinect2Sample
{
    public sealed partial class MainPage : Page
    {

        **private KinectSensor kinectSensor = null;**

        public MainPage()
        {
            **// one sensor is currently supported
            this.kinectSensor = KinectSensor.GetDefault();

            // open the sensor
            this.kinectSensor.Open();**

            this.InitializeComponent();
        }
    }
}

</code></pre>

<ol>
<li><p>Now add the Capability for the application to use the Kinect as a webcam and microphone device. Open the Package.appxmanifest by double clicking it in the Solution Explorer. Then navigate to the Capabilities tab then tick the Microphone and Webcam capabilities:</p></li>
<li><p>Make sure the Kinect 2.0 device is now plugged into both power and a USB3.0 port on the machine.</p></li>
<li><p>Build and Run the application, and you will be prompted to allow the Kinect:
<strong>lab01img06</strong>
Click Allow.
NOTE: if you click Block by accident, then you can re-enable the microphone and camera through settings for the app in the charms bar.</p></li>
<li><p>The same black screen will appear in the application but the infrared depth lights and the white status led of the Kinect 2 will turn on!
<strong>lab01img07</strong></p></li>
<li><p>Stop debugging now. The Kinect 2.0 is ready to be used and this is the end of the first exercise.</p></li>
</ol>

<h2>
<a id="summary" class="anchor" href="#summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>Summary</h2>

<p>This lab shows how to initially set up a Windows 8.1 Store application to work with Kinect for Windows 2.0 and so it references the SDK within WindowsPreview which is a Windows 8.1 extension SDK.</p>

<p>If you wish to make a Windows 8.1 desktop application (a non-store application) with full access to the .Net Framework, then there is a different Kinect reference they can use. To use the desktop Kinect library reference, follow these steps:
To add The Microsoft.Kinect.dll which uses the full .NetFramework library, follow these steps in the Reference Manager.
1. Click Browse… to browse to the installed location of the Kinect library.
2. Navigate to the following path: C:\Program Files\Microsoft SDKs\Kinect\v2.0_1409\Assemblies
3. Highlight the Microsoft.Kinect.dll library there and Click Add.
The Microsoft.Kinect.dll will be added in the reference manager already checked, so Click OK.
 <strong>lab01img08</strong></p>

<p>Currently the Kinect is simply turning on in the application, and with this confirmation you know that the application is activating the Kinect.
There is a code-base available which is the completed solution from the work in this lab. The next lab will begin from this code.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
